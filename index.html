<!DOCTYPE html>
<html>
  <head>
    <title>Gabut</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        color: #fff;
        font-family: Arial, sans-serif;
        overflow: hidden; /* Optional: Prevent scrolling */
      }

      main {
        width: 100%;
        height: 100vh;
        position: relative;
      }

      canvas {
        position: fixed;
        top: 0;
        left: 0;
        display: block;
        margin: 0 auto;
        width: 100%;
        object-fit: cover;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <main>
      <canvas id="background-screen"></canvas>
      <canvas id="play-screen"></canvas>
    </main>
    <script src="./src/Controller.js"></script>
    <script src="./src/Player.js"></script>
    <script src="./src/Utils.js"></script>
    <script src="./src/Block.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const [playCanvas, playCtx] = Utils.drawPlayScreen();
        const [backgroundCanvas, backgroundCtx] = Utils.drawBackgroundScreen();

        await delay(10);
        // Block lv1
        new Block(
          backgroundCtx,
          0,
          window.innerHeight - 48,
          Math.round(window.innerWidth / 48) + 1,
          'iron'
        );

        await delay(10);

        // Block lv2
        new Block(
          backgroundCtx,
          0,
          window.innerHeight - 48 * 5.5,
          Math.round(window.innerWidth / (48 * 2)) + 5,
          'iron'
        );

        await delay(10);

        // Block lv2 obs
        new Block(
          backgroundCtx,
          (Math.round(window.innerWidth / (48 * 2)) * 48 - 48) + (48 * 5),
          window.innerHeight - 48 * 6.5,
          1,
          'iron'
        );

        await delay(10);

        // Block lv3 lft
        new Block(
          backgroundCtx,
          0,
          window.innerHeight - 48 * 10,
          Math.round(window.innerWidth / (48 * 2)),
          'iron'
        );

        await delay(10);

        // Block lv3 obs
        new Block(
          backgroundCtx,
          Math.round(window.innerWidth / (48 * 2)) * 48 - 48,
          window.innerHeight - 48 * 11,
          1,
          'iron'
        );

        await delay(10);

        new Player(playCtx);
      });

      function delay(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
    </script>
  </body>
</html>
